<div class="settings-page compact">
  <h1 class="settings-title"><%= t("settings.title") %></h1>

  <div class="settings-block">
    <h2 class="settings-heading"><%= t("settings.account.title") %></h2>

    <p><strong><%= t("settings.account.name") %>:</strong> <%= @user.name.presence || "—" %></p>
    <p><strong><%= t("settings.account.email") %>:</strong> <%= @user.email %></p>
    <p><strong><%= t("settings.account.phone") %>:</strong> <%= @user.phone.presence || "—" %></p>

    <div class="mt-2">
      <%= link_to t("settings.account.edit_profile"), edit_user_registration_path, class: "link-row" %>
      <%= link_to t("settings.account.change_password"), edit_user_registration_path, class: "link-row" %>
      <%= link_to t("settings.account.logout"), destroy_user_session_path,
            data: { turbo_method: :delete }, class: "link-row logout" %>

      <%= button_to t("settings.account.delete"),
            registration_path(@user),
            method: :delete,
            data: { confirm: t("settings.account.confirm_delete") },
            class: "link-row danger" %>
    </div>
  </div>

  <!-- LANGUAGE -->
  <div class="settings-block">
    <h2 class="settings-heading"><%= t("settings.language.title") %></h2>

    <div class="language-select-wrapper">
      <select class="language-dropdown"
              onchange="window.location = window.location.pathname + '?locale=' + this.value;">
        <option value="uk" <%= 'selected' if I18n.locale == :uk %>><%= t("settings.language.uk") %></option>
        <option value="en" <%= 'selected' if I18n.locale == :en %>><%= t("settings.language.en") %></option>
      </select>
    </div>
  </div>

  <!-- SUBSCRIPTION -->
  <div class="settings-block">
    <h2 class="settings-heading"><%= t("settings.subscription.title") %></h2>
    <% plan =
        if @user.superadmin?
          "superadmin"
        elsif @user.on_trial?
          "trial"
        elsif @user.plan_name.present?
          @user.plan_name
        else
          "none"
        end %>

    <p><strong><%= t("settings.subscription.plan") %>:</strong> <%= plan %></p>

    <% if @user.subscription_expires_at.present? %>
      <p><strong><%= t("settings.subscription.active_until") %>:</strong> <%= @user.subscription_expires_at.strftime("%d.%m.%Y") %></p>
    <% elsif @user.on_trial? %>
      <p><strong><%= t("settings.subscription.days_left") %>:</strong> <%= @user.trial_days_left %></p>
    <% else %>
      <p><strong><%= t("settings.subscription.active_until") %>:</strong> <%= t("settings.subscription.none") %></p>
    <% end %>

    <% if @user.subscription_will_expire_soon? %>
      <p class="warning"><%= t("settings.subscription.expires_soon") %></p>
    <% elsif !@user.has_active_subscription? && !@user.superadmin? && !@user.on_trial? %>
      <p class="warning"><%= t("settings.subscription.expired") %></p>
    <% end %>

    <%= link_to t("settings.subscription.manage"), settings_subscription_path, class: "link-row primary" %>
  </div>
</div>
