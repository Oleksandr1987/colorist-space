<div class="analytics-header-bar">
  <%= link_to "←", expenses_path, class: "back-button-inline", title: "Назад" %>

  <h1>Витрати</h1>

  <%= link_to new_expense_path, class: "add-expense-button", title: "Додати витрату" do %>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
         class="lucide lucide-plus">
      <path d="M5 12h14"/><path d="M12 5v14"/>
    </svg>
  <% end %>
</div>


<% @expenses_by_month.each do |month_name, expenses| %>
  <div class="monthly-expense-group">
    <h2 class="name-of-month"><%= month_name %></h2>

    <ul class="expenses-list">
      <% expenses.each do |expense| %>
        <li class="expense-item" data-controller="popover">
          <div class="expense-info">
            <strong><%= expense.category %></strong>: <%= expense.note.presence || '—' %>
            — <%= expense.amount %> ₴ (<%= l(expense.spent_on, format: :short) %>)
          </div>

          <div class="expense-actions">
            <button class="popover-toggle" data-popover-target="button" data-action="click->popover#toggle">
              <svg xmlns="http://www.w3.org/2000/svg" class="lucide lucide-pencil" width="20" height="20"
                   viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                   stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 2a2.828 2.828 0 1 1 4 4L7 21l-4 1 1-4Z" />
                <path d="M16 5l3 3" />
              </svg>
            </button>

            <div class="popover-menu hidden" data-popover-target="menu">
              <%= link_to "Edit", edit_expense_path(expense), class: "popover-item" %>
              <%= button_to expense_path(expense), method: :delete,
                    data: { turbo_confirm: "Ви впевнені?" },
                    class: "popover-item delete-button" do %>
                Delete
              <% end %>
            </div>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>
